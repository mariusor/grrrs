image: alpine/edge
packages:
  - gcc
  - clang
  - valgrind
  - make
sources:
  - https://git.sr.ht/~mariusor/grrrs
environment:
  SNOWFLAGS: --no-maybes
  VGFLAGS: '--run-libc-freeres=yes --leak-check=full --show-leak-kinds=all --track-origins=yes'
tasks:
  - build: |
      cd grrrs
      CC=gcc make -C tests test
      make -C tests clean
      CC=clang make -C tests test
